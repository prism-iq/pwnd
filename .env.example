# L Investigation Framework - Environment Configuration
#
# "Protect the weak. Report truth. Fight evil." - The Code
#
# Copy this file to .env and customize for your deployment:
#   cp .env.example .env
#   nano .env

#===============================================================================
# DATABASE
#===============================================================================

# PostgreSQL connection string
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://lframework:changeme@localhost:5432/ldb

# Alternative: SQLite (for development only)
# DATABASE_TYPE=sqlite
# DB_SOURCES=/opt/rag/db/sources.db
# DB_GRAPH=/opt/rag/db/graph.db
# DB_SESSIONS=/opt/rag/db/sessions.db
# DB_AUDIT=/opt/rag/db/audit.db

#===============================================================================
# LLM CONFIGURATION
#===============================================================================

# Local LLM (Phi-3-Mini GGUF)
LLM_MODEL=phi-3-mini-4k-instruct.Q4_K_M.gguf
LLM_MODEL_PATH=/opt/rag/llm/phi-3-mini-4k-instruct.Q4_K_M.gguf
LLM_THREADS=4
LLM_CONTEXT=2048
LLM_GPU_LAYERS=0  # Set to >0 if you have GPU

# Local LLM server
LLM_MISTRAL_URL=http://127.0.0.1:8001/generate

#===============================================================================
# ANTHROPIC API (Claude Haiku)
#===============================================================================

# OPTIONAL: For advanced analysis (leave empty to skip)
# Get your API key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=sk-ant-api03-xxx

# Haiku rate limiting (budget protection)
HAIKU_DAILY_LIMIT=200          # Max calls per day
HAIKU_COST_LIMIT_USD=1.00      # Max cost per day (USD)

#===============================================================================
# API SERVER
#===============================================================================

# FastAPI host and port
HOST=127.0.0.1
PORT=8002

# Public domain (for production)
# DOMAIN=pwnd.icu

#===============================================================================
# RATE LIMITING (Anti-DDoS)
#===============================================================================

# Per-IP rate limits
MAX_REQUESTS_PER_MINUTE=2
MAX_REQUESTS_PER_HOUR=10
MAX_REQUESTS_PER_DAY=30

# Global rate limits
MAX_GLOBAL_REQUESTS_PER_HOUR=60
MAX_GLOBAL_REQUESTS_PER_DAY=200

# Queue settings
MAX_QUEUE_SIZE=20
QUEUE_TIMEOUT_SECONDS=30

#===============================================================================
# AUTHENTICATION
#===============================================================================

# Secret key for JWT tokens (generate with: python3 -c "import secrets; print(secrets.token_urlsafe(32))")
SECRET_KEY=your-secret-key-here-change-in-production

# Session expiration (hours)
TOKEN_EXPIRE_HOURS=24

#===============================================================================
# SECURITY
#===============================================================================

# Max query length (characters)
MAX_QUERY_LENGTH=10000

# Max auto-investigation queries
MAX_AUTO_QUERIES=20

# CORS origins (comma-separated)
# CORS_ORIGINS=https://pwnd.icu,https://www.pwnd.icu

#===============================================================================
# FEATURES
#===============================================================================

# Enable/disable features
ENABLE_AUTO_INVESTIGATE=true
ENABLE_GRAPH_ANALYSIS=true
ENABLE_COST_TRACKING=true

# Default language
DEFAULT_LANGUAGE=en  # en or fr

#===============================================================================
# DETECTIVE SYSTEM (The Code)
#===============================================================================

# Investigation focus
FOCUS_CRIMINOLOGY=true
PROTECT_VICTIMS=true
ANONYMIZE_MINORS=true

# Evidence export
EVIDENCE_EXPORT_DIR=/opt/rag/exports
ENABLE_SHA256_VERIFICATION=true

#===============================================================================
# LOGGING
#===============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log file path
LOG_FILE=/var/log/l-investigation/app.log

#===============================================================================
# DEPLOYMENT
#===============================================================================

# Environment: development, staging, production
ENVIRONMENT=production

# Enable debug mode (DO NOT use in production)
DEBUG=false
